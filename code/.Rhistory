setwd("C:\Users\nauner\tech\hidden_structure\code")
setwd("C:/Users/nauner/tech/hidden_structure/code")
ls9)
ls()
################################################################
# Testing different methods of initializing cluster membership.#
################################################################
#### k -means  #######
require(textir);data(congress109);cl <- NULL
#load algorithm
#source('hidden_structure.R')
source('Iterate.R')
X = congress109Counts
covars <- data.frame(gop=congress109Ideology$party=="R",
cscore=congress109Ideology$cs1)
covars$cscore <- covars$cscore -
tapply(covars$cscore,covars$gop,mean)[covars$gop+1]
rownames(covars) <- rownames(congress109Ideology)
#Initialization methods:
##### random ##########
make_cl1 <- function(i) {sample(1:i,size=dim(X)[1],replace=TRUE)}
##### k means on data ##########
make_cl2 <- function(i) {kmeans(X,i)$cluster}
##### k means on residuals#################
fits <- mnlm(cl, covars,X, bins=5, gamma=1, nlambda=10)
m <- rowSums(X)
resids <- X-m*predict(fits,covars,type="response") #(these are not really good residuals?)
make_cl3 <- function(i) {kmeans(resids,i)$cluster}
# k mean
hey <- iter_cluster(covars,make_cl1(num_cl),X,n.loop=5)
hey <- iter_cluster(covars,make_cl1(5),X,n.loop=5)
Y = covars
m <- rowSums(X)
# Turn our factor (membership = 1,2 or 3)
# into vector (membership = [0 1 0]), etc
cl_matrix <- sparse.model.matrix(formula(~0+as.factor(clusters)))
ncl <- dim(cl_matrix)[2]  #Keep track of how many clusters we're using.
Y<- Y_orig <- cBind(y,cl_matrix)
clusters <- make_cl1(5)
cl_matrix <- sparse.model.matrix(formula(~0+as.factor(clusters)))
ncl <- dim(cl_matrix)[2]  #Keep track of how many clusters we're using.
Y<- Y_orig <- cBind(y,cl_matrix)
d.Y <- dim(Y)[2]
y = covars
clusters
cl_matrix <- sparse.model.matrix(formula(~0+as.factor(clusters)))
ncl <- dim(cl_matrix)[2]  #Keep track of how many clusters we're using.
ncl
Y<- Y_orig <- cBind(y,cl_matrix)
y
cl_matrix
Y<- Y_orig <- cBind(sparse.matrix(y),cl_matrix)
str(y)
str(matrix(y))
Y<- Y_orig <- cBind(matrix(y),cl_matrix)
Y<- Y_orig <- cbind(matrix(y),cl_matrix)
Y<- Y_orig <- cbind(y,cl_matrix)
Y<- Y_orig <- cbind(matrix(y),cl_matrix)
head(Y)
Y
help(cbind)
Y<- Y_orig <- cbind(Matrix(y,sparse=TRUE),cl_matrix)
Matrix(y,sparse=TRUE)
Matrix(matrix(y),sparse=TRUE)
hey <- matrix(y)
hey
y
as.matrix(y)
Matrix(as.matrix(y),spare=TRUE)
Matrix(as.matrix(y),sparse=TRUE)
